<?php
/**
 * JLoaderTest
 *
 * @package   Joomla.UnitTest
 * @copyright Copyright (C) 2005 - 2012 Open Source Matters. All rights reserved.
 * @license   GNU General Public License
 */
//require_once 'PHPUnit/Framework.php';
require_once 'PHPUnit/Autoload.php';

// Register library prefix
JLoader::registerPrefix('Redform', JPATH_LIBRARIES . '/redform');

/**
 * Test class for tagsreplace.
 * Generated by PHPUnit on 2009-10-16 at 23:32:06.
 *
 * @package	redFORM.UnitTest
 */
class tagsreplaceTest extends JoomlaTestCase
{
	public function getTestReplaceData()
	{
		$formdata = new stdclass;
		$formdata->formname = 'test form';

		$answers = array();
		$answers[] = array('field' => 'name', 'field_id' => 2, 'value' => 'julien', 'type' => 'name');
		$answers[] = array('field' => 'email', 'field_id' => 3, 'value' => 'julien@redweb.dk', 'type' => 'email');

		return array(
			'nothing' => array($formdata, $answers, 'a first test', 'a first test'),
			'[formname]' => array($formdata, $answers, 'a first test with [formname]', 'a first test with ' . $formdata->formname),
			'[[form name]]' => array($formdata, $answers, 'a first test with [[formname]]', 'a first test with [' . $formdata->formname . ']'),
			'unknown answer' => array($formdata, $answers, 'a first test with field [answer_24]', 'a first test with field [answer_24]'),
			'known answer' => array($formdata, $answers, 'a first test with field [answer_2]', 'a first test with field julien'),
			'2 answers' => array($formdata, $answers, 'a first test with field [answer_2], and [answer_3]', 'a first test with field julien, and julien@redweb.dk'),
		);
	}

	/**
	 * test get country name function
	 *
	 * @param   object  $formdata  form data
	 * @param   object  $answers   answers
	 * @param   string  $text      text
	 * @param   string  $expected  expected text
	 *
	 * @return void
	 *
	 * @dataProvider getTestReplaceData
	 */
	public function testReplace($formdata, $answers, $text, $expected)
	{
		$helper = new RedformHelperTagsreplace($formdata, $answers);

		$resp = $helper->replace($text);

		$this->assertEquals($resp, $expected);
	}
}
